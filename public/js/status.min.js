window.SpigetStatus={options:{icons:{checking:"glyphicon glyphicon-question-sign",up:"glyphicon glyphicon-ok-sign",down:"glyphicon glyphicon-remove-sign"},colors:{checking:"gray",up:"#00b900",down:"red"}},display:{checking:function(t){t.removeClass(),t.css("color",window.SpigetStatus.options.colors.checking),t.addClass(window.SpigetStatus.options.icons.checking)},up:function(t){t.removeClass(),t.css("color",window.SpigetStatus.options.colors.up),t.addClass(window.SpigetStatus.options.icons.up)},down:function(t){t.removeClass(),t.css("color",window.SpigetStatus.options.colors.down),t.addClass(window.SpigetStatus.options.icons.down)}},servers:window.SpigetStatusServers||[],checkServers:function(){var t=0;$.each(window.SpigetStatus.servers,function(s,e){var a=$("<div style='color:darkgray;' class='server'></div>"),o=$("<a href='#' target='_blank'></a>"),n=$("<i style='color:gray;' class='glyphicon'></i>");n.appendTo(o),o.appendTo(a),a.appendTo($("#serverContainer")),a.css("background",e.color),window.SpigetStatus.display.checking(n),o.attr("title",e.name),o.attr("href",e.url),e.apiKey?$.ajax({method:"POST",url:"https://api.uptimerobot.com/v2/getMonitors?format=json&api_key="+e.apiKey,dataType:"json",success:function(s){console.log(s),s.monitors.monitor[0].status<=2?(window.SpigetStatus.display.up(n),t++,window.SpigetStatus.refreshGlobalStatus(t)):window.SpigetStatus.display.down(n)},error:function(t,s,e){window.SpigetStatus.display.down(n),console.log(e)}}):(console.warn("Server "+e.name+" does not have an API-Key"),setTimeout(function(){window.SpigetStatus.display.down(n)},Math.floor(1500*Math.random())+500)),e.url&&$.ajax({url:e.url+"/v2/status?callback=?",success:function(t){a.addClass("mode-"+t.status.server.mode)}})})},refreshGlobalStatus:function(t){$("#api-status").text(t+"/"+window.SpigetStatus.servers.length+" servers online"),t>=window.SpigetStatus.servers.length?($("#api-status-panel").removeClass("panel-warning"),$("#api-status-panel").removeClass("panel-danger"),$("#api-status-panel").addClass("panel-success"),$("#api-status").text("All servers online!")):t<=0&&($("#api-status-panel").removeClass("panel-warning"),$("#api-status-panel").addClass("panel-danger"),$("#api-status").text("All servers are offline"))},checkFetcher:function(){$.ajax({url:"https://api.spiget.org/v2/status",success:function(t){t.status.fetch.active?($("#fetcher-status").html("The API is <span class='fetcher-updating'>currently updating</span>"),$("#fetcher-details").html("The update started <span class='time'>"+moment(t.status.fetch.start).fromNow()+"</span>")):($("#fetcher-status").html("The API is <span class='fetcher-updated'>up to date</span>"),$("#fetcher-details").html("It was last updated <span class='time'>"+moment(t.status.fetch.start).fromNow()+"</span>"))}})},drawCharts:function(){var t=function(){var t=[],s=this.points.sort(function(t,s){return t.y>s.y?-1:t.y<s.y?1:0});$.each(s,function(s,e){t.push('<span style="color:'+e.series.color+';">'+e.series.name+"</span>: <strong>"+Highcharts.numberFormat(e.y,-1)+"</strong>")});var e='<span style="font-size:12px" class="text-muted">'+moment(this.x).format("dddd, MMMM Do YYYY - HH:00")+"</span><br/>";return e+=t.join("<br/>")};$.ajax({url:"https://api.spiget.org/v2/metrics/requests/30",success:function(s){console.log(s);var e={total:[],unique:[]};$.each(s,function(t,s){var a=1e3*s.timestamp;e.total.push([a,s.total]),e.unique.push([a,s.unique])});var a=[{name:"total",color:"black",data:e.total},{name:"unique",color:"blue",visible:!1,data:e.unique},{name:"trend",color:"gray",data:fitData(e.total).data}];$("#daily_requests_graph").highcharts({chart:{type:"spline",zoomType:"x",height:500},legend:{enabled:!0},plotOptions:{series:{marker:{enabled:!1,symbol:"circle",states:{hover:{enabled:!0}}}}},title:{text:"Daily Requests"},xAxis:{type:"datetime"},yAxis:{title:{text:"Number of Requests"}},tooltip:{backgroundColor:{linearGradient:[0,0,0,60],stops:[[0,"#FFFFFF"],[1,"#E0E0E0"]]},crossshairs:[!0,!0],shared:!0,followPointer:!0,followTouchMove:!0,formatter:t,useHTML:!0},series:a})}})}};
